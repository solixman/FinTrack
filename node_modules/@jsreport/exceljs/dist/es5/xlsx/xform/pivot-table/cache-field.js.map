{"version":3,"file":"cache-field.js","names":["CacheField","constructor","_ref","name","sharedItems","render","length","map","item","join","module","exports"],"sources":["../../../../../lib/xlsx/xform/pivot-table/cache-field.js"],"sourcesContent":["class CacheField {\n  constructor({name, sharedItems}) {\n    // string type\n    //\n    // {\n    //   'name': 'A',\n    //   'sharedItems': ['a1', 'a2', 'a3']\n    // }\n    //\n    // or\n    //\n    // integer type\n    //\n    // {\n    //   'name': 'D',\n    //   'sharedItems': null\n    // }\n    this.name = name;\n    this.sharedItems = sharedItems;\n  }\n\n  render() {\n    // PivotCache Field: http://www.datypic.com/sc/ooxml/e-ssml_cacheField-1.html\n    // Shared Items: http://www.datypic.com/sc/ooxml/e-ssml_sharedItems-1.html\n\n    // integer types\n    if (this.sharedItems === null) {\n      // TK(2023-07-18): left out attributes... minValue=\"5\" maxValue=\"45\"\n      return `<cacheField name=\"${this.name}\" numFmtId=\"0\">\n      <sharedItems containsSemiMixedTypes=\"0\" containsString=\"0\" containsNumber=\"1\" containsInteger=\"1\" />\n    </cacheField>`;\n    }\n\n    // string types\n    return `<cacheField name=\"${this.name}\" numFmtId=\"0\">\n      <sharedItems count=\"${this.sharedItems.length}\">\n        ${this.sharedItems.map(item => `<s v=\"${item}\" />`).join('')}\n      </sharedItems>\n    </cacheField>`;\n  }\n}\n\nmodule.exports = CacheField;\n"],"mappings":";;AAAA,MAAMA,UAAU,CAAC;EACfC,WAAWA,CAAAC,IAAA,EAAsB;IAAA,IAArB;MAACC,IAAI;MAAEC;IAAW,CAAC,GAAAF,IAAA;IAC7B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,WAAW,GAAGA,WAAW;EAChC;EAEAC,MAAMA,CAAA,EAAG;IACP;IACA;;IAEA;IACA,IAAI,IAAI,CAACD,WAAW,KAAK,IAAI,EAAE;MAC7B;MACA,OAAO,qBAAqB,IAAI,CAACD,IAAI;AAC3C;AACA,kBAAkB;IACd;;IAEA;IACA,OAAO,qBAAqB,IAAI,CAACA,IAAI;AACzC,4BAA4B,IAAI,CAACC,WAAW,CAACE,MAAM;AACnD,UAAU,IAAI,CAACF,WAAW,CAACG,GAAG,CAACC,IAAI,IAAI,SAASA,IAAI,MAAM,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;AACpE;AACA,kBAAkB;EAChB;AACF;AAEAC,MAAM,CAACC,OAAO,GAAGX,UAAU","ignoreList":[]}